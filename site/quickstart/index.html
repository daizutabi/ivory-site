<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="daizutabi">
  <link rel="canonical" href="https://ivory.daizutabi.net/quickstart/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Quickstart - Ivory</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="//use.fontawesome.com/releases/v5.8.1/css/all.css" rel="stylesheet" />
  <link href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css" rel="stylesheet" />
  <link href="../css/pheasant.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Quickstart";
    var mkdocs_page_input_path = "quickstart.py";
    var mkdocs_page_url = "/quickstart/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ivory</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Ivory Documentation</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Quickstart</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#installing-ivory">Installing Ivory</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#using-the-ivory-client">Using the Ivory Client</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example">Example</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#creating-numpy-data">Creating NumPy data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#set-of-data-classes">Set of Data classes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#defining-data-by-a-yaml-file">Defining data by a YAML file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#defining-a-model">Defining a model</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#defining-and-training-a-run">Defining and training a run</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ivory</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Quickstart</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                
<h1 id="quickstart"><span class="pheasant-header"><span class="header"><span class="title">Quickstart</span></span></span></h1>
<h2 id="installing-ivory"><span class="pheasant-header"><span class="header"><span class="title">Installing Ivory</span></span></span></h2>
<p>You install Ivory by pip command.</p>
<div class="pheasant-fenced-code"><div class="cell embed terminal"><div class="code"><pre><code class="bash">$ pip install ivory</code></pre></div></div></div>

<h2 id="using-the-ivory-client"><span class="pheasant-header"><span class="header"><span class="title">Using the Ivory Client</span></span></span></h2>
<p>Ivory has the <code>Client</code> class that manages the workflow of any machine learning. Let's create your first <code>Client</code> instance. In this quickstart, we are working with examples under the <code>examples</code> directory.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">import numpy as np

import ivory

client = ivory.create_client(&#34;examples&#34;)
client</code></pre></div>
<div class="report"><p><span class="count">[1]</span>
<span class="start">2020-05-19 18:09:42</span> (<span class="time">1.14s</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.15s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">Client(num_objects=2)</code></pre></div></div></div></div>

<p>The representation of the <code>client</code> shows that it has two objects. Objects that a client has can be accessed by <strong>index notation</strong> or <strong>dot notation</strong>.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">client[0]  # or client[&#39;tracker&#39;], or client.tracker</code></pre></div>
<div class="report"><p><span class="count">[2]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">4.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.16s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">Tracker(tracking_uri=&#39;file:///C:/Users/daizu/Documents/github/ivory/docs/examples/mlruns&#39;, artifact_location=None)</code></pre></div></div></div></div>

<p>The first object is a <code>Tracker</code> instance which connects Ivory to <a href="https://mlflow.org/docs/latest/tracking.html">MLFlow Tracking</a>.</p>
<p>You can get all of the objects. Because a <code>Client</code> insctance is an iterable, you can apply <code>list</code> to get the objects.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">list(client)</code></pre></div>
<div class="report"><p><span class="count">[3]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">7.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.16s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">[&#39;tracker&#39;, &#39;tuner&#39;]</code></pre></div></div></div></div>

<p>The second objects is named 'tuner'.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">client.tuner</code></pre></div>
<div class="report"><p><span class="count">[4]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">3.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.17s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">Tuner(storage=&#39;sqlite://&#39;, sampler=None, pruner=None, load_if_exists=True)</code></pre></div></div></div></div>

<p>A <code>Tuner</code> instance connects Ivory to <a href="https://preferred.jp/en/projects/optuna/">Optuna: A hyperparameter optimization framework</a></p>
<p>We can customize these objects with a YAML file named <code>client.yml</code> under the woking directory.  In our case, the file just contains the minimum settings.</p>
<div class="pheasant-header"><div class="other"><p class="caption"><span class="prefix">File</span> <span class="number">1</span>
<span class="title">client.yml</span></p>
<div class="content">

<div class="pheasant-fenced-code"><div class="cell embed file"><div class="code"><pre><code class="yaml">client:
  tracker:
  tuner:</code></pre></div></div></div>

</div></div></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A YAML file for client is not required. If there is no file for client, Ivory creates a default client with a tracker and without a tuner.</p>
<p>If you don't need a tracker, use <code>ivory.create_client(tracker=False)</code>.</p>
</div>
<h2 id="example"><span class="pheasant-header"><span class="header"><span class="title">Example</span></span></span></h2>
<h3 id="creating-numpy-data"><span class="pheasant-header"><span class="header"><span class="title">Creating NumPy data</span></span></span></h3>
<p>In this quickstart, we try to predict rectangles area from thier width and height using <a href="https://pytorch.org/">PyTorch</a>. First, prepare the data as <a href="https://numpy.org/">NumPy</a> arrays. In <code>example.py</code> under the working directory, a <code>create_data()</code> function is defined. The <code>ivory.create_client()</code> function automatically inserts the working directory, so that we can import the module.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">import example</code></pre></div>
<div class="report"><p><span class="count">[5]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">278ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.45s</span>)</span></p></div></div></div></div>

<p>Let's check the <code>create_data()</code> function definition and an example output:</p>
<div class="pheasant-header"><div class="other"><p class="caption"><span class="prefix">Code</span> <span class="number">1</span>
<span class="title">example.create_data</span></p>
<div class="content">

<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter source"><div class="code">
      <pre><code class="python">def create_data(num_samples=1000):
    xy = 4 * np.random.rand(num_samples, 2) + 1
    xy = xy.astype(np.float32)
    dx = 0.1 * (np.random.rand(num_samples) - 0.5)
    dy = 0.1 * (np.random.rand(num_samples) - 0.5)
    z = ((xy[:, 0] + dx) * (xy[:, 1] + dy)).astype(np.float32)
    z = z.reshape(-1, 1)
    return xy, z
</code></pre></div></div></div></div>

</div></div></div>

<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">xy, z = example.create_data(4)
xy</code></pre></div>
<div class="report"><p><span class="count">[7]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">4.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.46s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">array([[4.8599873, 4.9035373],
       [2.2044   , 4.6271234],
       [1.5120602, 3.9817734],
       [2.8079617, 2.0833135]], dtype=float32)</code></pre></div></div></div></div>

<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">z</code></pre></div>
<div class="report"><p><span class="count">[8]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">3.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.47s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">array([[24.145058 ],
       [10.034531 ],
       [ 6.059511 ],
       [ 5.9882655]], dtype=float32)</code></pre></div></div></div></div>

<h3 id="set-of-data-classes"><span class="pheasant-header"><span class="header"><span class="title">Set of Data classes</span></span></span></h3>
<p>Ivory defines a set of Data classes (<code>Data</code>, <code>Dataset</code>, <code>Datasets</code>, <code>DataLoaders</code>). First one is <code>ivory.core.data.Data</code>. Our own <code>Data</code> class inherits it.</p>
<div class="pheasant-header"><div class="other"><p class="caption"><span class="prefix">Code</span> <span class="number">2</span>
<span class="title">example.Data</span></p>
<div class="content">

<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter source"><div class="code">
      <pre><code class="python">@dataclass
class Data(ivory.core.data.Data):
    n_splits: int = 5

    DATA = create_data(1000)

    def init(self):
        self.input, self.target = self.DATA
        self.index = np.arange(len(self.input))
        self.fold = kfold_split(self.input, n_splits=self.n_splits)
        self.fold = np.where(self.fold == 4, -1, self.fold)
</code></pre></div></div></div></div>

</div></div></div>

<p>Here, <code>kfold_split</code> function creates a fold-array. In Ivory, fold number = <code>-1</code> means their samples are the test set.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">from ivory.utils.fold import kfold_split

kfold_split(np.arange(10), n_splits=3)</code></pre></div>
<div class="report"><p><span class="count">[10]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">6.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.49s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">array([2, 1, 0, 2, 0, 2, 1, 1, 0, 0], dtype=int8)</code></pre></div></div></div></div>

<p>Now, we can get a <code>Data</code> instance.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">data = example.Data()
data</code></pre></div>
<div class="report"><p><span class="count">[11]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">5.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.49s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">Data(n_splits=5)</code></pre></div></div></div></div>

<p>Second class <code>Dataset</code> is a class for one fold dataset. We can use a default <code>Dataset</code> for this simple example.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">import ivory.core.data

dataset = ivory.core.data.Dataset(data, mode=&#34;train&#34;, fold=1)
dataset</code></pre></div>
<div class="report"><p><span class="count">[12]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">4.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.50s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">Dataset(mode=&#39;train&#39;, num_samples=600)</code></pre></div></div></div></div>

<p>Using <code>get(index)</code> method, you can get a list of (index, input, target).</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">dataset.get(0)</code></pre></div>
<div class="report"><p><span class="count">[13]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">3.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.50s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">[0,
 array([3.9967277, 2.3258421], dtype=float32),
 array([9.455848], dtype=float32)]</code></pre></div></div></div></div>

<p>Next, <code>Datasets</code> is a collection class which has <code>train</code>, <code>val</code>, and <code>test</code> dataset.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">datasets = ivory.core.data.Datasets(data, ivory.core.data.Dataset, fold=0)
for mode in datasets:
    print(datasets[mode])</code></pre></div>
<div class="report"><p><span class="count">[14]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">7.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.51s</span>)</span></p></div></div><div class="cell jupyter stdout"><div class="code">
      <pre><code class="nohighlight">Dataset(mode=&#39;train&#39;, num_samples=600)
Dataset(mode=&#39;val&#39;, num_samples=200)
Dataset(mode=&#39;test&#39;, num_samples=200)</code></pre></div></div></div></div>

<p>Finally, <code>DataLoaders</code> is prepared for PyTorch.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">import ivory.torch.data

dataloaders = ivory.torch.data.DataLoaders(
    data, ivory.torch.data.Dataset, fold=0, batch_size=16
)
for mode in dataloaders:
    print(mode, dataloaders[mode])</code></pre></div>
<div class="report"><p><span class="count">[15]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">8.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.51s</span>)</span></p></div></div><div class="cell jupyter stdout"><div class="code">
      <pre><code class="nohighlight">train &lt;torch.utils.data.dataloader.DataLoader object at 0x000001CD59BACF08&gt;
val &lt;torch.utils.data.dataloader.DataLoader object at 0x000001CD59BACFC8&gt;
test &lt;torch.utils.data.dataloader.DataLoader object at 0x000001CD59BA1708&gt;</code></pre></div></div></div></div>

<h3 id="defining-data-by-a-yaml-file"><span class="pheasant-header"><span class="header"><span class="title">Defining data by a YAML file</span></span></span></h3>
<p>One of the Ivory features is to define everything in a YAML file.</p>
<div class="pheasant-header"><div class="other"><p class="caption"><span class="prefix">File</span> <span class="number">2</span>
<span class="title">data.yaml</span></p>
<div class="content">

<div class="pheasant-fenced-code"><div class="cell embed file"><div class="code"><pre><code class="yaml">library: torch
dataloaders:
  data:
    class: example.Data
    n_splits: 5
  dataset:
  batch_size: 10
  fold: 0</code></pre></div></div></div>

</div></div></div>

<p>Each dictionary value needs to have one of <code>class</code>, <code>call</code>, <code>def</code> key to create an object. If they are not found, Ivory uses the default classes according to the dictionary key and <code>library</code> value (<code>torch</code> in this case). Therfore, <code>dataloaders</code> and <code>dataset</code> are created by the default class <code>ivory.torch.data.DataLoaders</code> and <code>ivory.torch.data.Dataset</code>.</p>
<h3 id="defining-a-model"><span class="pheasant-header"><span class="header"><span class="title">Defining a model</span></span></span></h3>
<p>We use a simple MLP model here.</p>
<div class="pheasant-header"><div class="other"><p class="caption"><span class="prefix">Code</span> <span class="number">3</span>
<span class="title">example.Model</span></p>
<div class="content">

<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter source"><div class="code">
      <pre><code class="python">class Model(nn.Module):
    def __init__(self, hidden_sizes):
        super().__init__()
        layers = []
        for in_features, out_features in zip([2] + hidden_sizes, hidden_sizes + [1]):
            layers.append(nn.Linear(in_features, out_features))
        self.layers = nn.ModuleList(layers)

    def forward(self, x):
        for layer in self.layers[:-1]:
            x = F.relu(layer(x))
        return self.layers[-1](x)
</code></pre></div></div></div></div>

</div></div></div>

<h3 id="defining-and-training-a-run"><span class="pheasant-header"><span class="header"><span class="title">Defining and training a run</span></span></span></h3>
<p>Ivory defines a run by a YAML file. Here is a full example.</p>
<div class="pheasant-header"><div class="other"><p class="caption"><span class="prefix">File</span> <span class="number">3</span>
<span class="title">torch.yaml</span></p>
<div class="content">

<div class="pheasant-fenced-code"><div class="cell embed file"><div class="code"><pre><code class="yaml">library: torch
dataloaders:
  data:
    class: example.Data
    n_splits: 5
  dataset:
  batch_size: 10
  fold: 0
model:
  class: example.Model
  hidden_sizes: [100, 100]
optimizer:
  class: torch.optim.SGD
  params: $.model.parameters()
  lr: 1e-3
scheduler:
  class: torch.optim.lr_scheduler.ReduceLROnPlateau
  optimizer: $
  factor: 0.5
  patience: 4
results:
metrics:
  criterion:
    def: torch.nn.functional.mse_loss
monitor:
  metric: val_loss
early_stopping:
  patience: 10
trainer:
  epochs: 10
  verbose: 2</code></pre></div></div></div>

</div></div></div>

<p>Let's creata a run by <code>client.create_run</code></p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">run = client.create_run(&#39;torch&#39;)
run</code></pre></div>
<div class="report"><p><span class="count">[17]</span>
<span class="start">2020-05-19 18:09:43</span> (<span class="time">295ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">1.82s</span>)</span></p></div></div><div class="cell jupyter stderr"><div class="code">
      <pre><code class="nohighlight">[I 200519 18:09:43 tracker:48] A new experiment created with name: torch</code></pre></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">Run(id=&#39;5ac430ef2f1d4c3c8794a28194726cf9&#39;, name=&#39;run#0&#39;, num_objects=12)</code></pre></div></div></div></div>

<p>Once you get a run instance, then all you need is to start it.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">run.start()</code></pre></div>
<div class="report"><p><span class="count">[18]</span>
<span class="start">2020-05-19 18:11:40</span> (<span class="time">1.43s</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">3.27s</span>)</span></p></div></div><div class="cell jupyter stdout"><div class="code">
      <pre><code class="nohighlight">[epoch#0] loss=13.58 val_loss=9.378 lr=0.001 best
[epoch#1] loss=6.472 val_loss=6.849 lr=0.001 best
[epoch#2] loss=5.042 val_loss=5.088 lr=0.001 best
[epoch#3] loss=3.565 val_loss=3.415 lr=0.001 best
[epoch#4] loss=2.487 val_loss=2.533 lr=0.001 best
[epoch#5] loss=1.589 val_loss=2.133 lr=0.001 best
[epoch#6] loss=1.157 val_loss=1.638 lr=0.001 best
[epoch#7] loss=0.9969 val_loss=0.9716 lr=0.001 best
[epoch#8] loss=0.7363 val_loss=0.913 lr=0.001 best
[epoch#9] loss=0.6834 val_loss=1.007 lr=0.001</code></pre></div></div></div></div>

<p>You can get a history of metrics</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">run.metrics.history</code></pre></div>
<div class="report"><p><span class="count">[19]</span>
<span class="start">2020-05-19 18:14:02</span> (<span class="time">4.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">3.28s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">{&#39;loss&#39;: {0: 13.578895473480225,
  1: 6.47150728503863,
  2: 5.042469129959742,
  3: 3.565085874001185,
  4: 2.4874604493379593,
  5: 1.5887325555086136,
  6: 1.1567507199943066,
  7: 0.9969329769412677,
  8: 0.7362574823200703,
  9: 0.6833893636862437},
 &#39;val_loss&#39;: {0: 9.377516520023345,
  1: 6.849217140674591,
  2: 5.087719428539276,
  3: 3.414623647928238,
  4: 2.533419558405876,
  5: 2.133155971765518,
  6: 1.63829305768013,
  7: 0.9716287076473236,
  8: 0.9129781320691108,
  9: 1.006829033792019},
 &#39;lr&#39;: {0: 0.001,
  1: 0.001,
  2: 0.001,
  3: 0.001,
  4: 0.001,
  5: 0.001,
  6: 0.001,
  7: 0.001,
  8: 0.001,
  9: 0.001}}</code></pre></div></div></div></div>

<p>Also model output and target.</p>
<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">run.results.val.output[:5]</code></pre></div>
<div class="report"><p><span class="count">[20]</span>
<span class="start">2020-05-19 18:15:29</span> (<span class="time">6.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">3.33s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">array([[ 0.9674609],
       [ 8.910875 ],
       [ 7.507467 ],
       [11.987841 ],
       [ 7.7928557]], dtype=float32)</code></pre></div></div></div></div>

<div class="pheasant-fenced-code"><div class="cached"><div class="cell jupyter input"><div class="code"><pre><code class="python">run.results.val.target[:5]</code></pre></div>
<div class="report"><p><span class="count">[21]</span>
<span class="start">2020-05-19 18:15:29</span> (<span class="time">4.00ms</span>)
<span class="right"><span class="kernel">python3</span> (<span class="total">3.33s</span>)</span></p></div></div><div class="cell jupyter output"><div class="code"><pre><code class="nohighlight">array([[ 1.532435 ],
       [ 7.5503845],
       [ 6.0588183],
       [10.4058895],
       [ 6.2033644]], dtype=float32)</code></pre></div></div></div></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href=".." class="btn btn-neutral" title="Ivory Documentation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/daizutabi/ivory/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js"></script>
      <script src="../js/pheasant.js"></script>
      <script src="../search/main.js"></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
